# Mangelbehebung App

Eine Next.js-basierte Webanwendung zur Verwaltung und Dokumentation von Mängeln.

## Technologien

- Next.js 14
- TypeScript
- TailwindCSS
- Supabase
- React Hot Toast

## Voraussetzungen

- Node.js 18.x oder höher
- npm oder yarn
- Supabase Account

## Installation

1. Repository klonen:
```bash
git clone https://github.com/yourusername/lwz18_maengel.git
cd lwz18_maengel
```

2. Abhängigkeiten installieren:
```bash
npm install
# oder
yarn install
```

3. Umgebungsvariablen einrichten:
Erstellen Sie eine `.env.local` Datei im Root-Verzeichnis mit folgenden Variablen:
```env
NEXT_PUBLIC_SUPABASE_URL=ihre_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=ihr_supabase_anon_key
```

4. Entwicklungsserver starten:
```bash
npm run dev
# oder
yarn dev
```

Die Anwendung ist nun unter `http://localhost:3000` erreichbar.

## Deployment

### Vercel Deployment

1. Push Sie Ihren Code zu GitHub
2. Verbinden Sie Ihr Repository mit Vercel
3. Fügen Sie die Umgebungsvariablen in den Vercel-Projekteinstellungen hinzu
4. Vercel wird automatisch neue Deployments erstellen

### Manuelles Deployment

```bash
npm run build
npm run start
```

## Lizenz

MIT

## Support

Bei Fragen oder Problemen erstellen Sie bitte ein Issue im GitHub Repository.

## Funktionen

- Anzeige aller Mängelpunkte für Besucher
- Statusverwaltung (offen/erledigt) für jeden Mangelpunkt
- Admin-Login mit Benutzername/Passwort
- Erstellen neuer Mängelpunkte (nur für Admins)
- Löschen von Mängelpunkten (nur für Admins)
- Passwortänderung für Admins
- Statistik-Übersicht (Gesamtanzahl/offene Mängel)

## Supabase Setup

1. Erstellen Sie ein neues Supabase-Projekt
2. Erstellen Sie folgende Tabellen:

   ```sql
   -- Mängel-Tabelle
   create table maengel (
     id bigint generated by default as identity primary key,
     title text not null,
     comment text not null,
     image_path text not null,
     is_done boolean default false,
     created_at timestamp with time zone default timezone('utc'::text, now()) not null
   );

   -- Admin-Tabelle
   create table admin (
     id bigint generated by default as identity primary key,
     username text not null unique,
     password text not null
   );

   -- Standard-Admin einfügen
   insert into admin (username, password) values ('admin', 'admin');
   ```

3. RLS-Policies für die Tabellen:

   ```sql
   -- Mängel-Tabelle: Lesen für alle, Schreiben nur für authentifizierte Benutzer
   alter table maengel enable row level security;
   create policy "Mängel sind für alle lesbar" on maengel for select using (true);
   create policy "Nur Admins können Mängel erstellen/aktualisieren/löschen" on maengel for all using (auth.role() = 'authenticated');

   -- Admin-Tabelle: Lesen/Schreiben nur für authentifizierte Benutzer
   alter table admin enable row level security;
   create policy "Nur Admins können Admin-Daten verwalten" on admin for all using (auth.role() = 'authenticated');
   ```

## Bilder

Laden Sie die Bilder manuell in den `/public/images` Ordner hoch. Die Bildpfade in der Datenbank sollten entsprechend angepasst werden (z.B. `images/mangel1.jpg`). 